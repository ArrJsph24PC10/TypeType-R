"use strict";
(self["webpackChunktypey_type"] = self["webpackChunktypey_type"] || []).push([[378],{

/***/ 8378:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ FinishedSpeedChart)
});

// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(2483);
// EXTERNAL MODULE: ./node_modules/react-ga4/dist/index.js
var dist = __webpack_require__(3071);
// EXTERNAL MODULE: ./node_modules/d3-array/src/min.js
var min = __webpack_require__(231);
// EXTERNAL MODULE: ./node_modules/d3-array/src/max.js
var max = __webpack_require__(5069);
// EXTERNAL MODULE: ./node_modules/d3-array/src/bisector.js + 1 modules
var bisector = __webpack_require__(5562);
// EXTERNAL MODULE: ./node_modules/d3-format/src/defaultLocale.js + 8 modules
var defaultLocale = __webpack_require__(9211);
// EXTERNAL MODULE: ./node_modules/d3-scale/src/linear.js + 26 modules
var linear = __webpack_require__(9525);
// EXTERNAL MODULE: ./node_modules/d3-selection/src/pointer.js + 1 modules
var pointer = __webpack_require__(202);
// EXTERNAL MODULE: ./node_modules/d3-shape/src/curve/monotone.js
var monotone = __webpack_require__(8512);
;// ./src/components/Chart/utils.js
const combineChartDimensions=dimensions=>{let parsedDimensions={marginTop:16,marginRight:16,marginBottom:16,marginLeft:16,...dimensions};return{...parsedDimensions,boundedHeight:Math.max(parsedDimensions.height-parsedDimensions.marginTop-parsedDimensions.marginBottom,0),boundedWidth:Math.max(parsedDimensions.width-parsedDimensions.marginLeft-parsedDimensions.marginRight,0)};};const useChartDimensions=passedSettings=>{const ref=(0,react.useRef)();const dimensions=combineChartDimensions(passedSettings);const[width,changeWidth]=(0,react.useState)(0);const[height,changeHeight]=(0,react.useState)(0);(0,react.useEffect)(()=>{if(dimensions.width&&dimensions.height)return[ref,dimensions];const element=ref.current;const resizeObserver=new ResizeObserver(entries=>{if(!Array.isArray(entries))return;if(!entries.length)return;const entry=entries[0];if(width!==entry.contentRect.width)changeWidth(entry.contentRect.width);if(height!==entry.contentRect.height)changeHeight(entry.contentRect.height);});resizeObserver.observe(element);return()=>resizeObserver.unobserve(element);},[passedSettings,height,width,dimensions]);const newSettings=combineChartDimensions({...dimensions,width:dimensions.width||width,height:dimensions.height||height});return[ref,newSettings];};
// EXTERNAL MODULE: ./src/utils/formatters.js
var formatters = __webpack_require__(983);
// EXTERNAL MODULE: ./src/components/Icons/icon-images/TypeyTypeIcon.svg
var TypeyTypeIcon = __webpack_require__(1886);
// EXTERNAL MODULE: ./src/components/Icons/Icon.tsx
var Icon = __webpack_require__(5135);
// EXTERNAL MODULE: ./src/components/ErrorBoundary.tsx
var ErrorBoundary = __webpack_require__(8337);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(6723);
;// ./src/components/Chart/Axis.jsx
const formatter=(0,defaultLocale/* format */.GP)(",");// An ok default value: numberOfTicks = dimensions.boundedWidth / 80
const AxisHorizontal=_ref=>{let{dimensions,scale,gridLines,numberOfTicks,...props}=_ref;const ticks=(0,react.useMemo)(()=>{return scale.ticks(numberOfTicks).map(value=>({value,xOffset:scale(value)}));},[scale,numberOfTicks]);return/*#__PURE__*/(0,jsx_runtime.jsx)("g",{transform:`translate(0, ${dimensions.boundedHeight})`,role:"presentation",...props,children:ticks.map(_ref2=>{let{value,xOffset}=_ref2;return/*#__PURE__*/(0,jsx_runtime.jsxs)("g",{transform:`translate(${xOffset}, 0)`,role:"presentation",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("line",{y2:4,role:"presentation",style:{pointerEvents:"none",stroke:"#E3E3E3"}}),/*#__PURE__*/(0,jsx_runtime.jsx)("text",{"aria-hidden":"true",role:"presentation",style:{textAnchor:"middle",transform:"translateY(24px)",userSelect:"none"},children:formatter(value)},value)]},value);})});};// An ok default value: numberOfTicks = dimensions.boundedHeight / 80
const AxisVertical=_ref3=>{let{dimensions,scale,gridLines,numberOfTicks,...props}=_ref3;const[x1,x2]=gridLines===true?[-dimensions.boundedWidth,0]:[0,4];const ticks=(0,react.useMemo)(()=>{return scale.ticks(numberOfTicks).map(value=>({value,yOffset:scale(value)}));},[scale,numberOfTicks]);return/*#__PURE__*/(0,jsx_runtime.jsx)("g",{transform:`translate(${dimensions.boundedWidth}, 0)`,role:"presentation",...props,children:ticks.map((_ref4,i)=>{let{value,yOffset}=_ref4;return/*#__PURE__*/(0,jsx_runtime.jsxs)("g",{transform:`translate(0, ${yOffset})`,role:"presentation",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("line",{x1:x1,x2:x2,role:"presentation",style:{pointerEvents:"none",stroke:"#E3E3E3"}}),/*#__PURE__*/(0,jsx_runtime.jsx)("text",{"aria-hidden":"true",role:"presentation",style:{textAnchor:"start",transform:"translateX(8px)",userSelect:"none"},dy:"0.32em",children:`${formatter(value)}${i===ticks.length-1?" WPM":""}`},value)]},value);})});};const axisComponentsByDimension={x:AxisHorizontal,y:AxisVertical};const Axis=_ref5=>{let{dimension,dimensions,...props}=_ref5;const AxisByDimension=axisComponentsByDimension[dimension];if(!AxisByDimension)return null;return/*#__PURE__*/(0,jsx_runtime.jsx)(AxisByDimension,{dimensions:dimensions,...props});};/* harmony default export */ const Chart_Axis = (Axis);
;// ./src/components/Chart/Baseline.jsx
const Baseline=_ref=>{let{scaleRange,tickSize}=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)("path",{d:`M ${scaleRange[0]} ${tickSize} v ${-tickSize} H ${scaleRange[1]} v ${tickSize}`,fill:"none",stroke:"#A8A8A8",role:"presentation"});};/* harmony default export */ const Chart_Baseline = (Baseline);
;// ./src/components/Chart/Chart.jsx
const ChartContext=/*#__PURE__*/(0,react.createContext)();const useDimensionsContext=()=>useContext(ChartContext);const Chart=_ref=>{let{dimensions,onMouseMove=null,onTouchMove=null,onMouseOut=null,onTouchEnd=null,accessibleTitle,children}=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)(ChartContext.Provider,{value:dimensions,children:/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("h3",{className:"visually-hidden",id:"chart-title",children:accessibleTitle}),/*#__PURE__*/(0,jsx_runtime.jsxs)("svg",{width:dimensions.width,height:dimensions.height,"aria-labelledby":"chart-title",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("g",{transform:`translate(${dimensions.marginLeft}, ${dimensions.marginTop})`,role:"presentation",children:children}),/*#__PURE__*/(0,jsx_runtime.jsx)("rect",{x:0,y:0,width:dimensions.width,height:dimensions.height,fill:"transparent",onMouseMove:onMouseMove,onTouchMove:onTouchMove,onMouseOut:onMouseOut,onTouchEnd:onTouchEnd,role:"presentation"})]})]})});};/* harmony default export */ const Chart_Chart = (Chart);
;// ./src/components/Chart/Circles.jsx
const Circles=_ref=>{let{data,accessibleLabel,keyAccessor,xAccessor,yAccessor,colorAccessor,onFocus,onBlur,...props}=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)("g",{tabIndex:0,role:"list","aria-label":"Measurement points",children:data===null||data===void 0?void 0:data.map((d,i)=>/*#__PURE__*/(0,react.createElement)("circle",{...props,"aria-label":accessibleLabel(d),key:keyAccessor(d,i),cx:xAccessor(d),cy:yAccessor(d),r:4,role:"listitem",style:{fill:colorAccessor(d)},tabIndex:0,onFocus:e=>onFocus(e,d),onBlur:onBlur}))});};/* harmony default export */ const Chart_Circles = (Circles);
;// ./src/components/Chart/HighlightCircle.jsx
const HighlightCircle=_ref=>{let{datum,xAccessor,yAccessor,colorAccessor,...props}=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)("circle",{...props,role:"presentation",cx:xAccessor(datum),cy:yAccessor(datum),r:8,style:{fill:colorAccessor(datum),opacity:0.5}});};/* harmony default export */ const Chart_HighlightCircle = (HighlightCircle);
// EXTERNAL MODULE: ./node_modules/d3-shape/src/line.js
var line = __webpack_require__(5105);
// EXTERNAL MODULE: ./node_modules/d3-shape/src/area.js
var src_area = __webpack_require__(8710);
;// ./src/components/Chart/Line.jsx
const Line=_ref=>{let{type,data,xAccessor,yAccessor,y0Accessor,colorAccessor="#9880C2",interpolation,...props}=_ref;const lineGenerator=type==="line"?(0,line/* default */.A)().x(xAccessor).y(yAccessor).curve(interpolation):(0,src_area/* default */.A)().x(xAccessor).y(yAccessor).y0(y0Accessor).y1(yAccessor).curve(interpolation);const styles=type==="area"?{fill:colorAccessor,strokeWidth:0}:{fill:"none",stroke:colorAccessor,strokeWidth:"3px",strokeLinecap:"round"};return/*#__PURE__*/(0,jsx_runtime.jsx)("path",{...props,style:styles,d:lineGenerator(data),role:"presentation"});};/* harmony default export */ const Chart_Line = (Line);
;// ./src/components/Chart/Popover.jsx
const popoverMaxWidth=240;const halfPopoverMaxWidth=popoverMaxWidth/2;const Popover=_ref=>{let{dimensions,translateX,translateY,children,...props}=_ref;const leftEdge=translateX-halfPopoverMaxWidth<0;const rightEdge=translateX+halfPopoverMaxWidth>dimensions.width;const popoverStyles={backgroundColor:"#fff",border:"2px solid #E2E0E5",borderRadius:"4px",color:'var(--coolgrey-1000)',padding:"8px 16px",pointerEvents:"none",position:"absolute",textAlign:"center",transition:"transform 0.1s ease-in-out 0s",transform:`translate(
      calc(${leftEdge?"0%":rightEdge?"-100%":"-50%"} + ${translateX}px),
      calc(-100% + ${translateY}px)
    )`};/* NOTE: useful debugging logs */// console.log(`${xAccessor(data[dataIndex])} milliseconds`);
// console.log(`${format(",d")(xAccessor(data[dataIndex]) / 1000)} seconds`);
return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:popoverStyles,"aria-hidden":true,children:children});};/* harmony default export */ const Chart_Popover = (Popover);
;// ./src/components/Chart/Rule.jsx
const Rule=_ref=>{let{x1,y1,x2,y2,stroke}=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)("line",{x1:x1,y1:y1,x2:x2,y2:y2,fill:"none",stroke:stroke,role:"presentation"});};/* harmony default export */ const Chart_Rule = (Rule);
;// ./src/components/FinishedSpeedChart.jsx
const highlightCircleRadius=8;const tickSize=4;const claps=function(datum){let htmlOutput=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(htmlOutput){return datum.markedCorrect&&!datum.attemptPeak?/*#__PURE__*/(0,jsx_runtime.jsx)("span",{style:{backgroundColor:"transparent",borderBottom:"2px solid transparent"},role:"img","aria-label":" correct",children:"\xA0\uD83D\uDC4F"}):null;}else{return datum.markedCorrect&&!datum.attemptPeak?", correct!":"";}};function FinishedSpeedChart(_ref){let{data}=_ref;const[highlightedDatum,setHighlightedDatum]=(0,react.useState)(null);const[ref,dimensions]=useChartDimensions({marginTop:24,marginRight:96,marginBottom:36,marginLeft:8});(0,react.useEffect)(()=>{dist/* default */.Ay.event({category:"CompletedLessonWithChart",action:"CompletedLessonWithChart",label:"CompletedLessonWithChart"});},[]);const xAccessor=(0,react.useCallback)(d=>d.elapsedTime,[]);const yAccessor=(0,react.useCallback)(d=>d.wordsPerMinute,[]);const keyAccessor=(_,i)=>i;const nominalAccessor=d=>d.material;const minimumStrokes=4;const colorAccessor=d=>{if("materialIndex"in d&&d.materialIndex<minimumStrokes){return"#868091";}if(d.attemptPeak){return d.markedCorrect?"#CD840E":"#E17547";}else{return d.markedCorrect?"#9880C2":"#E26F99";}};const backgroundColorAccessor=d=>{if(d.attemptPeak){return d.markedCorrect?"#FCF5E9":"#FAEFEA";}else{return d.markedCorrect?"#F1EEF6":"#FAEBF0";}};// eslint-disable-next-line react-hooks/exhaustive-deps
const xScale=(0,react.useCallback)(data===null?null:(0,linear/* default */.A)().domain([Math.floor((0,min/* default */.A)(data.dataPoints,xAccessor)/1000)*1000,Math.ceil((0,max/* default */.A)(data.dataPoints,xAccessor)/1000)*1000]).range([0,dimensions.boundedWidth]),[data.dataPoints,xAccessor,dimensions]);const maxY=(0,max/* default */.A)(data.dataPoints,yAccessor);const maxYPlusBuffer=maxY*1.2;const yScaleDomainMax=maxYPlusBuffer=>{if(maxYPlusBuffer<60)return 60;if(maxYPlusBuffer<100)return 100;if(maxYPlusBuffer<200)return 200;if(maxYPlusBuffer<300)return 300;return 400;};// eslint-disable-next-line react-hooks/exhaustive-deps
const yScale=(0,react.useCallback)(data===null?null:(0,linear/* default */.A)().domain([0,yScaleDomainMax(maxYPlusBuffer)]).range([dimensions.boundedHeight,0]).nice(),[dimensions,maxYPlusBuffer]);const xAccessorScaled=(0,react.useCallback)(d=>xScale(xAccessor(d)),[xAccessor,xScale]);const yAccessorScaled=(0,react.useCallback)(d=>yScale(yAccessor(d)),[yAccessor,yScale]);// eslint-disable-next-line react-hooks/exhaustive-deps
const y0AccessorScaled=(0,react.useCallback)(data===null?null:yScale(yScale.domain()[0]),[data,yScale]);const circleDiameter=8;const crowdedDataPoints=data.dataPoints.length*circleDiameter>dimensions.boundedWidth;const bisect=(0,bisector/* default */.A)(d=>xAccessor(d));const onMove=event=>{try{var _pointer;const pointerX=((_pointer=(0,pointer/* default */.A)(event))===null||_pointer===void 0?void 0:_pointer[0])||0-dimensions.marginLeft;const pointerXValue=xScale.invert(pointerX);const nearestXIndex=bisect.center(data.dataPoints,pointerXValue);const datum=data.dataPoints[nearestXIndex];setHighlightedDatum(datum);}catch(error){console.error(error);}};const onOut=()=>{setHighlightedDatum(null);};const onCircleFocus=(_,d)=>{d?setHighlightedDatum(d):setHighlightedDatum(null);};const accessibleLabel=d=>{const wpmText=`${(0,defaultLocale/* format */.GP)(",d")(yAccessor(d))} WPM`;const hinted=`${d.hintWasShown?" (hinted). ":""}`;if(d.markedCorrect){return`${d.material}: ${wpmText}${claps(d)}${hinted}`;}else{if(d.material===d.typedText){return`${d.material}: ${wpmText}${claps(d)}. ${hinted}`;}else{return`${d.material}: ${wpmText}${claps(d)}; you typed: ${d.typedText}. ${hinted}`;}}};return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"mt3 mb1 relative",style:{height:"240px"},ref:ref,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"chart-logo-lockup absolute bg-white mb0 pointer-none"// style={{ top: dimensions.marginTop}}
,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("p",{className:"flex items-end pr1 mb0",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icon/* default */.A,{iconSVGImport:TypeyTypeIcon/* default */.A,color:"currentColor",width:"1.25em",height:"1.25em",className:"icon mr1",style:{transform:"translateY(-0.333333em)"}}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"heading-link__logo-text","aria-hidden":true,children:"Typey\xA0Type"})]})}),highlightedDatum===null?null:/*#__PURE__*/(0,jsx_runtime.jsx)(ErrorBoundary/* default */.A,{relative:true,vanish:true,children:/*#__PURE__*/(0,jsx_runtime.jsxs)(Chart_Popover,{dimensions:dimensions,translateX:xAccessorScaled(highlightedDatum)+dimensions.marginLeft,translateY:Math.max(yAccessorScaled(highlightedDatum)+dimensions.marginTop-highlightCircleRadius,-highlightCircleRadius// prevents positioning higher than the chart
),children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("p",{className:"mw-240 mb0 mt1 flex",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"current-phrase-material truncate px05",children:nominalAccessor(highlightedDatum)}),claps(highlightedDatum,true)]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("p",{className:"mw-240 mb1 flex",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"truncate px05 bg-info",style:{backgroundColor:backgroundColorAccessor(highlightedDatum),borderBottom:`2px solid ${colorAccessor(highlightedDatum)}`},children:highlightedDatum.typedText.replace(/^ $/," ")}),claps(highlightedDatum,true)]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("p",{className:"mb0",children:["materialIndex"in highlightedDatum&&highlightedDatum.materialIndex<minimumStrokes?"~":"",(0,defaultLocale/* format */.GP)(",d")(yAccessor(highlightedDatum))," WPM",highlightedDatum.hintWasShown?/*#__PURE__*/(0,jsx_runtime.jsx)("span",{"aria-label":"(hinted)",role:"img",children:"\xA0\u2139\uFE0F"}):null]})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_Chart,{dimensions:dimensions,onMouseMove:onMove,onTouchMove:onMove,onMouseOut:onOut,onTouchEnd:onOut,accessibleTitle:"Line chart of your typing speed over time",children:data===null?null:/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_Axis,{dimension:"y",dimensions:dimensions,scale:yScale,numberOfTicks:4,gridLines:true}),/*#__PURE__*/(0,jsx_runtime.jsx)("g",{role:"presentation",transform:`translate(0, ${dimensions.boundedHeight})`,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_Baseline,{scaleRange:xScale.range(),tickSize:tickSize})}),/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_Line,{type:"line",data:data.dataPoints.filter(d=>!d.attemptPeak),xAccessor:xAccessorScaled,yAccessor:yAccessorScaled,y0Accessor:y0AccessorScaled,interpolation:monotone/* monotoneX */.G,colorAccessor:"#9880C2"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_Line,{type:"area",data:data.dataPoints.filter(d=>!d.attemptPeak),xAccessor:xAccessorScaled,yAccessor:yAccessorScaled,y0Accessor:y0AccessorScaled,interpolation:monotone/* monotoneX */.G,colorAccessor:"rgba(60%, 50%, 76%, 0.2)"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_Line,{type:"line",data:data.dataPoints.filter(d=>!d.attemptPeak&&"materialIndex"in d&&d.materialIndex<minimumStrokes),xAccessor:xAccessorScaled,yAccessor:yAccessorScaled,y0Accessor:y0AccessorScaled,interpolation:monotone/* monotoneX */.G,colorAccessor:"#868091"}),crowdedDataPoints?data.dataPoints.filter(d=>!d.attemptPeak&&!("materialIndex"in d&&d.materialIndex<minimumStrokes)&&!d.markedCorrect).map(d=>/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_Rule,{x1:xAccessorScaled(d),y1:yAccessorScaled(d)-8,x2:xAccessorScaled(d),y2:yAccessorScaled(d)+8,stroke:colorAccessor(d)//"#E8686A"
},d.materialIndex)):/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_Circles,{data:data.dataPoints,accessibleLabel:accessibleLabel,keyAccessor:keyAccessor,xAccessor:xAccessorScaled,yAccessor:yAccessorScaled,colorAccessor:colorAccessor,onFocus:onCircleFocus,onBlur:onOut}),highlightedDatum===null?null:/*#__PURE__*/(0,jsx_runtime.jsx)(Chart_HighlightCircle,{datum:highlightedDatum,xAccessor:xAccessorScaled,yAccessor:yAccessorScaled,colorAccessor:colorAccessor}),/*#__PURE__*/(0,jsx_runtime.jsxs)("text",{textAnchor:"start",transform:`translate(0, ${dimensions.boundedHeight})`,dy:"1.5em",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("tspan",{role:"img","aria-label":"Start time",children:"\u23F1"})," ",(0,formatters/* durationFormatter */.z)(xScale.domain()[0])]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("text",{textAnchor:"end",transform:`translate(${xScale.range()[1]}, ${dimensions.boundedHeight})`,dy:"1.5em",children:[(0,formatters/* durationFormatter */.z)(xScale.domain()[1])," ",/*#__PURE__*/(0,jsx_runtime.jsx)("tspan",{role:"img","aria-label":"Finished time",children:"\u23F1"})]})]})})]});}

/***/ })

}]);
//# sourceMappingURL=378.2eaa9bc4.chunk.js.map